source('D:/Courses/Functional-and-shape-data-analysis/Introduction-FDA.R', echo=TRUE)
install.packages("fda")
source('D:/Courses/Functional-and-shape-data-analysis/Introduction-FDA.R', echo=TRUE)
library(fda)
data("pinch")
data(pinch)
data(pinch)
pinch
View(pinch)
View(pinch)
library(fda)
bsbasis<-create.bspline.basis(c(0,3),breaks=c(0,1,2,3), norder=3)
eval.basis(2.5,bsbasis)
daybasis<-create.fourier.basis(c(0,365), 3)
constant<-create.constant.basis(c(0,3))
polynomial<-create.monomial.basis(c(0,3),nbasis=3)
View(bsbasis)
View(bsbasis)
View(bsbasis)
View(bsbasis)
data(growth)
library(fda)
data(growth)
### Example 2.3
heightbasis12<-create.bspline.basis(c(1,18),nbasis=12, norder=6)
heightmat.boy<-growth$hgtm
heightmat.girl<-growth$hgtf
basismatrix<-eval.basis(growth$age, heightbasis12)
coef.boy<-lsfit(basismatrix,heightmat.boy, intercept=FALSE)$coef
coef.girl<-lsfit(basismatrix,heightmat.girl, intercept=FALSE)$coef
t<-seq(1,18, 0.0001)
basismatrix<-eval.basis(t, heightbasis12)
smooth.boy1<-basismatrix%*%coef.boy[,1]
plot(growth$age, heightmat.boy[,1])
lines(t,smooth.boy1)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.boy<-H.matrix%*%heightmat.boy
fitted.girl<-H.matrix%*%heightmat.girl
plot(fitted.boy[,1],heightmat.boy[,1])
View(growth)
View(growth)
View(heightmat.boy)
View(heightmat.boy)
View(heightbasis12)
View(heightbasis12)
View(basismatrix)
View(basismatrix)
View(bsbasis)
View(bsbasis)
View(heightmat.boy)
View(heightmat.boy)
heightbasis12<-create.bspline.basis(c(1,18),nbasis=12, norder=6)
heightmat.boy<-growth$hgtm
heightmat.girl<-growth$hgtf
basismatrix<-eval.basis(growth$age, heightbasis12)
coef.boy<-lsfit(basismatrix,heightmat.boy, intercept=FALSE)$coef
coef.girl<-lsfit(basismatrix,heightmat.girl, intercept=FALSE)$coef
t<-seq(1,18, 0.001)
basismatrix<-eval.basis(t, heightbasis12)
smooth.boy1<-basismatrix%*%coef.boy[,1]
plot(growth$age, heightmat.boy[,1])
lines(t,smooth.boy1)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.boy<-H.matrix%*%heightmat.boy
fitted.girl<-H.matrix%*%heightmat.girl
plot(fitted.boy[,1],heightmat.boy[,1])
heightbasis12<-create.bspline.basis(c(1,18),nbasis=12, norder=6)
heightmat.boy<-growth$hgtm
heightmat.girl<-growth$hgtf
basismatrix<-eval.basis(growth$age, heightbasis12)
coef.boy<-lsfit(basismatrix,heightmat.boy, intercept=FALSE)$coef
coef.girl<-lsfit(basismatrix,heightmat.girl, intercept=FALSE)$coef
t<-seq(1,18, 0.0001)
basismatrix<-eval.basis(t, heightbasis12)
smooth.boy1<-basismatrix%*%coef.boy[,1]
plot(growth$age, heightmat.boy[,1])
lines(t,smooth.boy1)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.boy<-H.matrix%*%heightmat.boy
fitted.girl<-H.matrix%*%heightmat.girl
plot(fitted.boy[,1],heightmat.boy[,1])
View(basismatrix)
View(basismatrix)
data(pinch)
View(pinch)
View(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis(c(1:151), bspline15)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
View(basismatrix)
View(basismatrix)
heightbasis12<-create.bspline.basis(c(1,18),nbasis=12, norder=6)
heightmat.boy<-growth$hgtm
heightmat.girl<-growth$hgtf
basismatrix<-eval.basis(growth$age, heightbasis12)
coef.boy<-lsfit(basismatrix,heightmat.boy, intercept=FALSE)$coef
coef.girl<-lsfit(basismatrix,heightmat.girl, intercept=FALSE)$coef
t<-seq(1,18, 0.0001)
basismatrix<-eval.basis(t, heightbasis12)
smooth.boy1<-basismatrix%*%coef.boy[,1]
heightbasis12<-create.bspline.basis(c(1,18),nbasis=12, norder=6)
heightmat.boy<-growth$hgtm
heightmat.girl<-growth$hgtf
basismatrix<-eval.basis(growth$age, heightbasis12)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
basismatrix<-eval.basis(t, bspline15)
smooth.pinch<-basismatrix%*%coef.pinch[,1]
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
basismatrix<-eval.basis(t, bspline15)
smooth.pinch<-basismatrix%*%coef.pinch[,1]
plot((1:151), pinch[,1])
lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
library(fda)
bsbasis<-create.bspline.basis(c(0,3),breaks=c(0,1,2,3), norder=3)
eval.basis(2.5,bsbasis)
daybasis<-create.fourier.basis(c(0,365), 3)
constant<-create.constant.basis(c(0,3))
polynomial<-create.monomial.basis(c(0,3),nbasis=3)
### Example 2.3
heightbasis12<-create.bspline.basis(c(1,18),nbasis=12, norder=6)
heightmat.boy<-growth$hgtm
heightmat.girl<-growth$hgtf
basismatrix<-eval.basis(growth$age, heightbasis12)
coef.boy<-lsfit(basismatrix,heightmat.boy, intercept=FALSE)$coef
coef.girl<-lsfit(basismatrix,heightmat.girl, intercept=FALSE)$coef
t<-seq(1,18, 0.0001)
basismatrix<-eval.basis(t, heightbasis12)
smooth.boy1<-basismatrix%*%coef.boy[,1]
plot(growth$age, heightmat.boy[,1])
lines(t,smooth.boy1)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
H.matrix<-t(basismatrix)%*%solve(t(basismatrix)%*%basismatrix)%*%basismatrix
basismatrix<-eval.basis(t, heightbasis12)
smooth.boy1<-basismatrix%*%coef.boy[,1]
plot(growth$age, heightmat.boy[,1])
lines(t,smooth.boy1)
H.matrix<-t(basismatrix)%*%solve(t(basismatrix)%*%basismatrix)%*%basismatrix
View(basismatrix)
View(basismatrix)
solve(t(basismatrix)%*%basismatrix)
heightbasis12<-create.bspline.basis(c(1,18),nbasis=12, norder=6)
heightmat.boy<-growth$hgtm
heightmat.girl<-growth$hgtf
basismatrix<-eval.basis(growth$age, heightbasis12)
coef.boy<-lsfit(basismatrix,heightmat.boy, intercept=FALSE)$coef
coef.girl<-lsfit(basismatrix,heightmat.girl, intercept=FALSE)$coef
#t<-seq(1,18, 0.0001)
#basismatrix<-eval.basis(t, heightbasis12)
#smooth.boy1<-basismatrix%*%coef.boy[,1]
#plot(growth$age, heightmat.boy[,1])
#lines(t,smooth.boy1)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.boy<-H.matrix%*%heightmat.boy
fitted.girl<-H.matrix%*%heightmat.girl
heightbasis12<-create.bspline.basis(c(1,18),nbasis=12, norder=6)
heightmat.boy<-growth$hgtm
heightmat.girl<-growth$hgtf
basismatrix<-eval.basis(growth$age, heightbasis12)
coef.boy<-lsfit(basismatrix,heightmat.boy, intercept=FALSE)$coef
coef.girl<-lsfit(basismatrix,heightmat.girl, intercept=FALSE)$coef
#t<-seq(1,18, 0.0001)
#basismatrix<-eval.basis(t, heightbasis12)
#smooth.boy1<-basismatrix%*%coef.boy[,1]
#plot(growth$age, heightmat.boy[,1])
#lines(t,smooth.boy1)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.boy<-H.matrix%*%heightmat.boy
fitted.girl<-H.matrix%*%heightmat.girl
plot(fitted.boy[,1],heightmat.boy[,1])
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
plot(fitted.pinch[,1],heightmat.pinch[,1])
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
plot(fitted.pinch[,1],pinch[,1])
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
for i in c(1:151){
plot(fitted.pinch[,i],pinch[,i])
}
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
for(i in c(1:151)){
plot(fitted.pinch[,i],pinch[,i])
}
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
for(i in c(1:20)){
plot(fitted.pinch[,i],pinch[,i])
}
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
matlines(1:151, fitted.pinch, col="red")
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
matlines(1:151, fitted.pinch)
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
matlines(1:151, fitted.pinch)
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
plot.new()
matlines(1:151, fitted.pinch)
library(fda)
data(pinch)
bspline15<-create.bspline.basis(c(1,151),nbasis=15, norder=4)
basismatrix<-eval.basis((1:151), bspline15)
coef.pinch<-lsfit(basismatrix,pinch, intercept=FALSE)$coef
t<-seq(1,151, 0.1)
#basismatrix<-eval.basis(t, bspline15)
#smooth.pinch<-basismatrix%*%coef.pinch[,1]
#plot((1:151), pinch[,1])
#lines(t,smooth.pinch)
H.matrix<-basismatrix%*%solve(t(basismatrix)%*%basismatrix)%*%t(basismatrix)
fitted.pinch<-H.matrix%*%pinch
plot(fitted.pinch[,1],pinch[,1],type = 'l')
for(i in c(2:20)){
lines(fitted.pinch[,i],pinch[,i])
}
